{%- if AI_EXTENSIONS is defined %}
AI_EXTENSIONS:
{%- for profile_key, profile_config in AI_EXTENSIONS.items() %}
  {{ profile_key }}:
  {%- for key, value in profile_config.items() %}
    {{ key }}: "{{ value }}"
  {%- endfor %}
{%- endfor %}
{%- elif AI_EXTENSIONS_OPENAI_API_KEY is defined or AI_EXTENSIONS_ANTHROPIC_API_KEY is defined %}
AI_EXTENSIONS:
  {%- if AI_EXTENSIONS_OPENAI_API_KEY is defined %}
  openai:
    API_KEY: "{{ AI_EXTENSIONS_OPENAI_API_KEY }}"
    LITELLM_MODEL: "{{ AI_EXTENSIONS_OPENAI_MODEL | default("gpt-4.1-mini") }}"
  {%- endif %}
  {%- if AI_EXTENSIONS_ANTHROPIC_API_KEY is defined %}
  anthropic:
    API_KEY: "{{ AI_EXTENSIONS_ANTHROPIC_API_KEY }}"
    LITELLM_MODEL: "{{ AI_EXTENSIONS_ANTHROPIC_MODEL | default("claude-3-haiku-20240307") }}"
  {%- endif %}
{% endif %}
{%- if AI_EXTENSIONS_MODEL_PROXY is defined %}
AI_EXTENSIONS_MODEL_PROXY:
  {%- for proxy in AI_EXTENSIONS_MODEL_PROXY %}
  - location_regex: "{{ proxy.location_regex }}"
    file: "{{ proxy.file }}"
  {%- endfor %}
{%- endif %}
{%- if AI_EXTENSIONS_FIELD_FILTERS is defined %}
AI_EXTENSIONS_FIELD_FILTERS:
  {%- if AI_EXTENSIONS_FIELD_FILTERS.allowed_fields is defined %}
  allowed_fields:
    {%- for f in AI_EXTENSIONS_FIELD_FILTERS.allowed_fields %}
    - "{{ f }}"
    {%- endfor %}
  {%- endif %}

  {%- if AI_EXTENSIONS_FIELD_FILTERS.allowed_field_substrings is defined %}
  allowed_field_substrings:
    {%- for s in AI_EXTENSIONS_FIELD_FILTERS.allowed_field_substrings %}
    - "{{ s }}"
    {%- endfor %}
  {%- endif %}
{%- endif %}
